{
  "description": "Comprehensive test suite for JD-153: Corporate Travel Policy Management system covering onboarding modal, policy creation workflow (3 steps), policy updates, activation/deactivation, and approval workflows with validation rules for flights and stays booking scenarios.",
  "generatedFiles": [
    {
      "fileName": "travel-policy-management.spec.ts",
      "code": "// JD-153: Corporate Travel Policy Management Test Suite\nimport { test, expect } from '@playwright/test';\n\ntest.describe('Travel Policy Management - JD-153', () => {\n  const baseUrl = 'https://testenv.com';\n  \n  test.beforeEach(async ({ page }) => {\n    await page.goto(baseUrl);\n    // Assuming user needs to be logged in as corporate admin\n    await page.waitForLoadState('networkidle');\n  });\n\n  test.describe('Onboarding Modal', () => {\n    test('should display onboarding modal for new users', async ({ page }) => {\n      await page.goto(`${baseUrl}/corporate/dashboard`);\n      \n      // Verify onboarding modal appears\n      const onboardingModal = page.locator('[data-testid=\"policy-onboarding-modal\"]');\n      await expect(onboardingModal).toBeVisible();\n      \n      // Verify modal content\n      await expect(page.locator('text=Policy Management')).toBeVisible();\n      await expect(page.locator('[data-testid=\"close-onboarding\"]')).toBeVisible();\n      await expect(page.locator('[data-testid=\"try-it-now\"]')).toBeVisible();\n    });\n\n    test('should close onboarding modal and not show again', async ({ page }) => {\n      await page.goto(`${baseUrl}/corporate/dashboard`);\n      \n      // Close modal\n      await page.click('[data-testid=\"close-onboarding\"]');\n      await expect(page.locator('[data-testid=\"policy-onboarding-modal\"]')).not.toBeVisible();\n      \n      // Refresh page and verify modal doesn't appear again\n      await page.reload();\n      await expect(page.locator('[data-testid=\"policy-onboarding-modal\"]')).not.toBeVisible();\n    });\n\n    test('should redirect to Create Policy when clicking Try It Now', async ({ page }) => {\n      await page.goto(`${baseUrl}/corporate/dashboard`);\n      \n      await page.click('[data-testid=\"try-it-now\"]');\n      await expect(page).toHaveURL(/.*\\/create-policy/);\n      \n      // Verify modal doesn't appear again after redirect\n      await page.goto(`${baseUrl}/corporate/dashboard`);\n      await expect(page.locator('[data-testid=\"policy-onboarding-modal\"]')).not.toBeVisible();\n    });\n  });\n\n  test.describe('Create Policy - Step 1: Policy Details', () => {\n    test.beforeEach(async ({ page }) => {\n      await page.goto(`${baseUrl}/create-policy`);\n    });\n\n    test('should validate mandatory fields in Policy Details', async ({ page }) => {\n      // Try to continue without filling mandatory fields\n      await page.click('[data-testid=\"save-continue\"]');\n      \n      // Verify validation errors\n      await expect(page.locator('[data-testid=\"policy-name-error\"]')).toContainText('Policy Name is required');\n      await expect(page.locator('[data-testid=\"effective-from-error\"]')).toContainText('Effective From is required');\n    });\n\n    test('should successfully fill and save Policy Details', async ({ page }) => {\n      const today = new Date().toISOString().split('T')[0];\n      const futureDate = new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\n      \n      // Fill mandatory fields\n      await page.fill('[data-testid=\"policy-name\"]', 'Test Travel Policy');\n      await page.fill('[data-testid=\"effective-from\"]', today);\n      \n      // Fill optional fields\n      await page.fill('[data-testid=\"effective-to\"]', futureDate);\n      await page.selectOption('[data-testid=\"default-approval-workflow\"]', 'Standard Approval');\n      \n      // Save and continue\n      await page.click('[data-testid=\"save-continue\"]');\n      \n      // Verify navigation to step 2\n      await expect(page.locator('[data-testid=\"step-2-policy-rules\"]')).toBeVisible();\n    });\n\n    test('should validate date selection constraints', async ({ page }) => {\n      const yesterday = new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString().split('T')[0];\n      \n      // Try to set effective from date in the past\n      await page.fill('[data-testid=\"effective-from\"]', yesterday);\n      await page.blur('[data-testid=\"effective-from\"]');\n      \n      await expect(page.locator('[data-testid=\"effective-from-error\"]')).toContainText('Date cannot be in the past');\n    });\n  });\n\n  test.describe('Create Policy - Step 2: Policy Rules - Flight Rules', () => {\n    test.beforeEach(async ({ page }) => {\n      await page.goto(`${baseUrl}/create-policy`);\n      // Complete step 1\n      await page.fill('[data-testid=\"policy-name\"]', 'Test Policy');\n      await page.fill('[data-testid=\"effective-from\"]', new Date().toISOString().split('T')[0]);\n      await page.click('[data-testid=\"save-continue\"]');\n    });\n\n    test('should create flight rule with all mandatory fields', async ({ page }) => {\n      // Fill Rule Details\n      await page.fill('[data-testid=\"rule-name\"]', 'Flight Rule 1');\n      await page.selectOption('[data-testid=\"product-select\"]', 'Flight');\n      \n      // Fill Target Employee (at least one required)\n      await page.selectOption('[data-testid=\"branch-select\"]', ['Head Office', 'Branch A']);\n      await page.selectOption('[data-testid=\"designation-select\"]', ['Manager', 'Senior Manager']);\n      \n      // Fill Flight Booking Scenario - Mandatory fields\n      await page.fill('[data-testid=\"max-budget\"]', '5000');\n      await page.selectOption('[data-testid=\"journey-type\"]', ['Domestic', 'International']);\n      await page.selectOption('[data-testid=\"cabin-class\"]', ['Economy', 'Business']);\n      \n      // Fill optional fields\n      await page.fill('[data-testid=\"max-fare-limit\"]', '3000');\n      await page.selectOption('[data-testid=\"trip-type\"]', ['One Way', 'Round Trip']);\n      await page.fill('[data-testid=\"trip-duration\"]', '48');\n      await page.selectOption('[data-testid=\"airlines\"]', ['Airline A', 'Airline B']);\n      \n      // Save rule\n      await page.click('[data-testid=\"save-rule\"]');\n      \n      // Verify rule is added\n      await expect(page.locator('[data-testid=\"rule-list\"]')).toContainText('Flight Rule 1');\n    });\n\n    test('should validate mandatory fields for flight rules', async ({ page }) => {\n      await page.fill('[data-testid=\"rule-name\"]', 'Incomplete Flight Rule');\n      await page.selectOption('[data-testid=\"product-select\"]', 'Flight');\n      \n      // Try to save without mandatory fields\n      await page.click('[data-testid=\"save-rule\"]');\n      \n      // Verify validation errors\n      await expect(page.locator('[data-testid=\"target-employee-error\"]')).toContainText('At least one target employee criteria is required');\n      await expect(page.locator('[data-testid=\"max-budget-error\"]')).toContainText('Max budget is required');\n      await expect(page.locator('[data-testid=\"journey-type-error\"]')).toContainText('Journey type is required');\n      await expect(page.locator('[data-testid=\"cabin-class-error\"]')).toContainText('Cabin class is required');\n    });\n\n    test('should display flight-specific fields when Flight product is selected', async ({ page }) => {\n      await page.selectOption('[data-testid=\"product-select\"]', 'Flight');\n      \n      // Verify flight-specific fields are visible\n      await expect(page.locator('[data-testid=\"max-fare-limit\"]')).toBeVisible();\n      await expect(page.locator('[data-testid=\"journey-type\"]')).toBeVisible();\n      await expect(page.locator('[data-testid=\"trip-type\"]')).toBeVisible();\n      await expect(page.locator('[data-testid=\"cabin-class\"]')).toBeVisible();\n      await expect(page.locator('[data-testid=\"airlines\"]')).toBeVisible();\n      \n      // Verify stay-specific fields are not visible\n      await expect(page.locator('[data-testid=\"star-rating-limit\"]')).not.toBeVisible();\n      await expect(page.locator('[data-testid=\"hotel-chains\"]')).not.toBeVisible();\n    });\n  });\n\n  test.describe('Create Policy - Step 2: Policy Rules - Stay Rules', () => {\n    test.beforeEach(async ({ page }) => {\n      await page.goto(`${baseUrl}/create-policy`);\n      // Complete step 1\n      await page.fill('[data-testid=\"policy-name\"]', 'Test Policy');\n      await page.fill('[data-testid=\"effective-from\"]', new Date().toISOString().split('T')[0]);\n      await page.click('[data-testid=\"save-continue\"]');\n    });\n\n    test('should create stay rule with mandatory fields', async ({ page }) => {\n      // Fill Rule Details\n      await page.fill('[data-testid=\"rule-name\"]', 'Stay Rule 1');\n      await page.selectOption('[data-testid=\"product-select\"]', 'Stay');\n      \n      // Fill Target Employee\n      await page.selectOption('[data-testid=\"department-select\"]', ['IT', 'Finance']);\n      \n      // Fill Stay Booking Scenario - Mandatory fields\n      await page.fill('[data-testid=\"max-budget\"]', '2000');\n      \n      // Fill optional fields\n      await page.selectOption('[data-testid=\"star-rating-limit\"]', '3');\n      await page.fill('[data-testid=\"min-notice-period\"]', '7');\n      await page.selectOption('[data-testid=\"hotel-chains\"]', ['Chain A', 'Chain B']);\n      \n      // Save rule\n      await page.click('[data-testid=\"save-rule\"]');\n      \n      // Verify rule is added\n      await expect(page.locator('[data-testid=\"rule-list\"]')).toContainText('Stay Rule 1');\n    });\n\n    test('should validate star rating logic', async ({ page }) => {\n      await page.selectOption('[data-testid=\"product-select\"]', 'Stay');\n      await page.selectOption('[data-testid=\"star-rating-limit\"]', '3');\n      \n      // Verify helper text shows correct logic\n      await expect(page.locator('[data-testid=\"star-rating-help\"]')).toContainText('Will show hotels with 1, 2, and 3 stars');\n    });\n\n    test('should display stay-specific fields when Stay product is selected', async ({ page }) => {\n      await page.selectOption('[data-testid=\"product-select\"]', 'Stay');\n      \n      // Verify stay-specific fields are visible\n      await expect(page.locator('[data-testid=\"star-rating-limit\"]')).toBeVisible();\n      await expect(page.locator('[data-testid=\"hotel-chains\"]')).toBeVisible();\n      await expect(page.locator('[data-testid=\"room-type\"]')).toBeVisible();\n      \n      // Verify flight-specific fields are not visible\n      await expect(page.locator('[data-testid=\"journey-type\"]')).not.toBeVisible();\n      await expect(page.locator('[data-testid=\"cabin-class\"]')).not.toBeVisible();\n    });\n  });\n\n  test.describe('Create Policy - Step 3: Review & Publish', () => {\n    test.beforeEach(async ({ page }) => {\n      await page.goto(`${baseUrl}/create-policy`);\n      // Complete steps 1 and 2\n      await page.fill('[data-testid=\"policy-name\"]', 'Test Policy');\n      await page.fill('[data-testid=\"effective-from\"]', new Date().toISOString().split('T')[0]);\n      await page.click('[data-testid=\"save-continue\"]');\n      \n      // Add a rule\n      await page.fill('[data-testid=\"rule-name\"]', 'Test Rule');\n      await page.selectOption('[data-testid=\"product-select\"]', 'Flight');\n      await page.selectOption('[data-testid=\"branch-select\"]', 'Head Office');\n      await page.fill('[data-testid=\"max-budget\"]', '5000');\n      await page.selectOption('[data-testid=\"journey-type\"]', 'Domestic');\n      await page.selectOption('[data-testid=\"cabin-class\"]', 'Economy');\n      await page.click('[data-testid=\"save-rule\"]');\n      await page.click('[data-testid=\"continue-to-review\"]');\n    });\n\n    test('should display policy summary for review', async ({ page }) => {\n      // Verify policy details are displayed\n      await expect(page.locator('[data-testid=\"policy-summary\"]')).toContainText('Test Policy');\n      await expect(page.locator('[data-testid=\"rules-summary\"]')).toContainText('Test Rule');\n      \n      // Verify action options\n      await expect(page.locator('[data-testid=\"action-allowed\"]')).toBeVisible();\n      await expect(page.locator('[data-testid=\"action-require-approval\"]')).toBeVisible();\n    });\n\n    test('should show approval workflow dropdown when require approval is selected', async ({ page }) => {\n      await page.click('[data-testid=\"action-require-approval\"]');\n      \n      await expect(page.locator('[data-testid=\"approval-workflow-select\"]')).toBeVisible();\n      await expect(page.locator('[data-testid=\"approval-workflow-select\"] option')).toHaveCount.toBeGreaterThan(0);\n    });\n\n    test('should validate that action is selected before publishing', async ({ page }) => {\n      await page.click('[data-testid=\"